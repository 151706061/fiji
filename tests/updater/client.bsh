#!/bin/sh
/*/. 2>/dev/null; exec "$(dirname "$0")"/../../fiji "$0" "$@" # exec with fiji */

import java.io.File;

if (bsh.args.length == 0) {
	print("Usage: "  + this.interpreter.getSourceFileInfo()
                + " <beanshell-script>");
        System.exit(1);
}

if (bsh.args.length > 1 && bsh.args[1].equals("--no-hidden"))
	hidden = false;

libDir = new File(this.interpreter.getSourceFileInfo()).getParentFile();
source(new File(libDir, "lib.bsh").getAbsolutePath());

import fiji.Main;

import ij.ImageJ;

new Thread() {
	void run() {
		Main.premain();
		new ImageJ(null, hidden ? ImageJ.NO_SHOW : ImageJ.STANDALONE);
		Main.setup();
		Main.postmain();
	}
}.start();

eval(bsh.args[0]);